<!--result.wxml-->
<view class="container">
  <text class="h1"><text class="bold">{{yearMonth}}</text>月考成绩</text>
  <text class="h2" wx:if="{{role==0}}">（{{subject=='全科'? class : (class + ' - ' +subject)}}）</text>
  <text class="h2" wx:if="{{role==1}}">（{{class + ' - ' + studentName}}）</text>

  <!-- 总体情况 -->
  <text class="title" wx:if="{{role==0 && subject!='全科'}}">— 总体情况 —</text>
  <view class="total r3" wx:if="{{role==0 && subject!='全科'}}">
    <view>最高分<text>120</text></view>
    <view>最低分<text>44</text></view>
    <view>平均分<text>60</text></view>
  </view>
  <view class="total r2" wx:if="{{role==0 && subject!='全科'}}">
    <view>优秀率<text>30%</text></view>
    <view>及格率<text>50%</text></view>
  </view>

  <!-- 各班对比 -->
  <text class="title" wx:if="{{role==0 && subject!='全科'}}">— 各班对比 —</text>
  <view class="topChart">
    <ec-canvas id="topChart" canvas-id="topChart" ec="{{ ecTop }}"></ec-canvas>
  </view>

  <!-- 分数段统计 -->
  <text class="title" wx:if="{{role==0 && subject!='全科'}}">— 分数段统计 —</text>
  <view class="chartWrap">
    <view class="tab">
      <text class="swiper-tab-list {{currentTab1==0 ? 'active' : ''}}" data-current="0" data-name="currentTab1" bindtap="swichNav">饼状图</text>
      <text class="swiper-tab-list {{currentTab1==1 ? 'active' : ''}}" data-current="1" data-name="currentTab1" bindtap="swichNav">柱状图</text>
    </view>
    <view class="secondChart">
      <ec-canvas id="secondChart" canvas-id="secondChart" ec="{{ ecSecond }}"></ec-canvas>
    </view>
  </view>
  
  <!-- 错题统计 -->
  <text class="title" wx:if="{{role==0 && subject!='全科'}}">— 错题统计 —</text>
  <view class="error-scale" wx:if="{{role==0 && subject!='全科'}}">
    <view class="section" wx:for="{{wrongQuestions}}" wx:key="id">
      <text>{{item.topic}}</text>
      <view class="progress-box">
        <view class="progress-bar" style="width: {{item.percentage}}">{{item.percentage}}</view>
      </view>
    </view>
  </view>

  <!-- 全对题统计 -->
  <text class="title" wx:if="{{role==0 && subject!='全科'}}">— 全对题统计 —</text>
  <view class="all-right" wx:if="{{role==0 && subject!='全科'}}">
    <text wx:if="{{allRight.length==0}}">无</text>
    <text wx:for="{{allRight}}" wx:key="id">{{item}}</text>
  </view>

  <text class="title" wx:if="{{role==0}}">— 成绩排名 —</text>
  <!-- 班主任 -->
  <view class="table" wx:if="{{role==0 && subject == '全科'}}">
    <view class="tr">
      <view class="th">姓名</view>
      <view class="th">总分</view>
      <view class="th">学校排名</view>
      <view class="th">较上次</view>
    </view>
    <view class="tr" wx:for="{{scoreArray}}" wx:key="id">
      <view class="td">{{item.studentName}}</view>
      <view class="td">{{item.totalScore}}</view>
      <view class="td">{{item.schoolRanking}}</view>
      <view class="td" wx:if="{{item.ranking == 0}}">--</view>
      <view class="td" wx:if="{{item.ranking > 0}}"><image class="up" src="/imgs/arrow_up.svg"></image>{{item.ranking}}</view>
      <view class="td" wx:if="{{item.ranking < 0}}"><image class="down" src="/imgs/arrow_down.svg"></image>{{-item.ranking}}</view>
    </view>
  </view>
  <!-- 单科老师 -->
  <view class="table" wx:if="{{role==0 && subject != '全科'}}">
    <view class="tr">
      <view class="th w64">姓名</view>
      <view class="th w40">{{subject+'成绩'}}</view>
      <view class="th">单科<text class="br"></text>学校排名</view>
      <view class="th">总分<text class="br"></text>学校排名</view>
      <view class="th">客观题<text class="br"></text>正确率</view>
    </view>
    <view class="tr single" wx:for="{{scoreArray}}" wx:key="id">
      <view class="td w64" bindtap="getStudentInfo" data-name="{{item.studentName}}">{{item.studentName}}</view>
      <view class="td w40" style="color: {{item.totalScore < pass? 'red': '#666'}}">{{item.totalScore}}</view>
      <view class="td" wx:if="{{item.ranking == 0}}">{{item.schoolRanking}}(--)</view>
      <view class="td" wx:if="{{item.ranking > 0}}">{{item.schoolRanking}}(<image class="up" src="/imgs/arrow_up.svg"></image>{{item.ranking}})</view>
      <view class="td" wx:if="{{item.ranking < 0}}">{{item.schoolRanking}}(<image class="down" src="/imgs/arrow_down.svg"></image>{{-item.ranking}})</view>
      <view class="td" wx:if="{{item.totalScoreFloatingRanking == 0}}">{{item.totalScoreRanking}}(--)</view>
      <view class="td" wx:if="{{item.totalScoreFloatingRanking > 0}}">{{item.totalScoreRanking}}(<image class="up" src="/imgs/arrow_up.svg"></image>{{item.totalScoreFloatingRanking}})</view>
      <view class="td" wx:if="{{item.totalScoreFloatingRanking < 0}}">{{item.totalScoreRanking}}(<image class="down" src="/imgs/arrow_down.svg"></image>{{-item.totalScoreFloatingRanking}})</view>
      <view class="td">{{item.objectiveQuestionsCorrectRate}}</view>
    </view>
  </view>
  <!-- 家长 -->
  <view class="table parantsTable" wx:if="{{role==1}}">
    <view class="tr">
      <view class="th">科目</view>
      <view class="th">成绩</view>
      <view class="th">分数区间<text class="br"></text>（年级）</view>
      <view class="th">较上次</view>
    </view>
    <view class="tr" wx:for="{{listResult}}" wx:key="id">
      <view class="td">{{item.subject}}</view>
      <view class="td">{{item.socre}}</view>
      <view class="td">前{{item.scoreRange}}%</view>
      <view class="td" wx:if="{{item.ranking == 0}}">--</view>
      <view class="td" wx:if="{{item.ranking > 0}}"><image class="up" src="/imgs/arrow_up.svg"></image>{{item.ranking}}</view>
      <view class="td" wx:if="{{item.ranking < 0}}"><image class="down" src="/imgs/arrow_down.svg"></image>{{-item.ranking}}</view>
    </view>
  </view>

  <!-- 走势图弹窗 -->
  <view class="popup" style="top: {{popupTop}}; left: {{popupLeft}}" wx:if="{{showTrendChart}}">
    <text class="popip-title">学校排名走势</text>
    <text class="popip-subtitle">（小明）</text>
    <view class="trendChart">
      <ec-canvas id="trendChart" canvas-id="trendChart" ec="{{ ecThree }}"></ec-canvas>
    </view>
  </view>

  <!-- 作文分数段统计 -->
  <text class="title" wx:if="{{role==0}}">— 作文分数段统计 —</text>
  <text class="h2" wx:if="{{role==0}}">（{{studentName}}）</text>
  <view class="chartWrap">
    <view class="tab">
      <text class="swiper-tab-list {{currentTab2==0 ? 'active' : ''}}" data-current="0" data-name="currentTab2" bindtap="swichNav">饼状图</text>
      <text class="swiper-tab-list {{currentTab2==1 ? 'active' : ''}}" data-current="1" data-name="currentTab2" bindtap="swichNav">柱状图</text>
    </view>
    <view class="bottomChart">
      <ec-canvas id="bottomChart" canvas-id="bottomChart" ec="{{ ecBottom }}"></ec-canvas>
    </view>
  </view>
  
</view>